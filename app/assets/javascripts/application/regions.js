$(window).load( function() {

  // var regions = {};
});

function scaleRangeValue(value,min,max) {
  var scaleMax = 100;
  var scaleMin = 3;

  scaledValue = ((scaleMax-scaleMin)*(value-min))/(max-min)+scaleMin;
  return scaledValue;
}
function illustrateMap(regions) {
  var regionLookup = {
    "Maine": "United States Court of Appeals for the 1st Circuit",
    "Massachusetts": "United States Court of Appeals for the 1st Circuit",
    "New Hampshire": "United States Court of Appeals for the 1st Circuit",
    "Puerto Rico": "United States Court of Appeals for the 1st Circuit",
    "Rhode Island": "United States Court of Appeals for the 1st Circuit",
    "Connecticut": "United States Court of Appeals for the 2nd Circuit",
    "New York": "United States Court of Appeals for the 2nd Circuit",
    "Vermont": "United States Court of Appeals for the 2nd Circuit",
    "Delaware": "United States Court of Appeals for the 3rd Circuit",
    "New Jersey": "United States Court of Appeals for the 3rd Circuit",
    "Pennsylvania": "United States Court of Appeals for the 3rd Circuit",
    "US Virgin Islands": "United States Court of Appeals for the 3rd Circuit",
    "Maryland": "United States Court of Appeals for the 4th Circuit",
    "North Carolina": "United States Court of Appeals for the 4th Circuit",
    "South Carolina": "United States Court of Appeals for the 4th Circuit",
    "Virginia": "United States Court of Appeals for the 4th Circuit",
    "West Virginia": "United States Court of Appeals for the 4th Circuit",
    "Louisiana": "United States Court of Appeals for the 5th Circuit",
    "Mississippi": "United States Court of Appeals for the 5th Circuit",
    "Texas": "United States Court of Appeals for the 5th Circuit",
    "Kentucky": "United States Court of Appeals for the 6th Circuit",
    "Michigan": "United States Court of Appeals for the 6th Circuit",
    "Ohio": "United States Court of Appeals for the 6th Circuit",
    "Tennessee": "United States Court of Appeals for the 6th Circuit",
    "Illinois": "United States Court of Appeals for the 7th Circuit",
    "Indiana": "United States Court of Appeals for the 7th Circuit",
    "Wisconsin": "United States Court of Appeals for the 7th Circuit",
    "Arkansas": "United States Court of Appeals for the 8th Circuit",
    "Iowa": "United States Court of Appeals for the 8th Circuit",
    "Minnesota": "United States Court of Appeals for the 8th Circuit",
    "Missouri": "United States Court of Appeals for the 8th Circuit",
    "Nebraska": "United States Court of Appeals for the 8th Circuit",
    "North Dakota": "United States Court of Appeals for the 8th Circuit",
    "South Dakota": "United States Court of Appeals for the 8th Circuit",
    "Alaska": "United States Court of Appeals for the 9th Circuit",
    "Arizona": "United States Court of Appeals for the 9th Circuit",
    "California": "United States Court of Appeals for the 9th Circuit",
    "Guam": "United States Court of Appeals for the 9th Circuit",
    "Hawaii": "United States Court of Appeals for the 9th Circuit",
    "Idaho": "United States Court of Appeals for the 9th Circuit",
    "Montana": "United States Court of Appeals for the 9th Circuit",
    "Nevada": "United States Court of Appeals for the 9th Circuit",
    "Northern Mariana Islands": "United States Court of Appeals for the 9th Circuit",
    "Oregon": "United States Court of Appeals for the 9th Circuit",
    "Washington": "United States Court of Appeals for the 9th Circuit",
    "Colorado": "United States Court of Appeals for the 10th Circuit",
    "Kansas": "United States Court of Appeals for the 10th Circuit",
    "New Mexico": "United States Court of Appeals for the 10th Circuit",
    "Oklahoma": "United States Court of Appeals for the 10th Circuit",
    "Utah": "United States Court of Appeals for the 10th Circuit",
    "Wyoming": "United States Court of Appeals for the 10th Circuit",
    "Alabama": "United States Court of Appeals for the 11th Circuit",
    "Florida": "United States Court of Appeals for the 11th Circuit",
    "Georgia": "United States Court of Appeals for the 11th Circuit"
  }
  var regionCenters = {
    "United States Court of Appeals for the 1st Circuit": [43.77109381775651,-69.873046875],
    "United States Court of Appeals for the 2nd Circuit" :[43.89789239125797,-76.201171875],
    "United States Court of Appeals for the 3rd Circuit" :[40.914455,-76.849078],
    "United States Court of Appeals for the 4th Circuit" :[36.347875,-78.312992],
    "United States Court of Appeals for the 5th Circuit" :[30.332983, -93.536680],
    "United States Court of Appeals for the 6th Circuit" :[38.774920, -83.924759],
    "United States Court of Appeals for the 7th Circuit" :[41.471080, -88.335509],
    "United States Court of Appeals for the 8th Circuit" :[42.455678, -96.825528],
    "United States Court of Appeals for the 9th Circuit" :[37.802835, -118.338745],
    "United States Court of Appeals for the 10th Circuit" :[37.100303, -105.725651],
    "United States Court of Appeals for the 11th Circuit" :[30.425281, -83.064370],
  }
  var regionGeometry = {
  "type": "FeatureCollection",
  "features": [
  { "type": "Feature", "properties": { "name": "United States Court of Appeals for the 1st Circuit" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -67.941222, 18.126927 ], [ -67.846219, 18.127576 ], [ -67.820915, 18.084711 ], [ -67.885547, 18.036472 ], [ -67.941222, 18.126927 ] ] ], [ [ [ -65.342068, 18.34529 ], [ -65.255933, 18.342117 ], [ -65.221568, 18.320959 ], [ -65.283269, 18.280214 ], [ -65.342068, 18.34529 ] ] ], [ [ [ -65.57686, 18.103224 ], [ -65.50592, 18.152605 ], [ -65.287962, 18.148097 ], [ -65.291235, 18.103469 ], [ -65.57686, 18.103224 ] ] ], [ [ [ -67.239128357404596, 18.373827545192004 ], [ -67.042276, 18.511594 ], [ -65.564931, 18.325042 ], [ -66.041704, 17.934941 ], [ -67.183457, 17.931135 ], [ -67.239128357404596, 18.373827545192004 ] ] ], [ [ [ -68.92401, 43.885407 ], [ -68.849009, 43.849841 ], [ -68.888483, 43.803781 ], [ -68.944433, 43.835326 ], [ -68.92401, 43.885407 ] ] ], [ [ [ -71.631472, 41.166678 ], [ -71.593342, 41.237428 ], [ -71.54541, 41.24273 ], [ -71.51921, 41.149624 ], [ -71.631472, 41.166678 ] ] ], [ [ [ -70.275526, 41.310464 ], [ -70.049053, 41.391702 ], [ -69.960181, 41.264546 ], [ -70.211479, 41.248765 ], [ -70.275526, 41.310464 ] ] ], [ [ [ -70.833802, 41.353386 ], [ -70.603555, 41.482384 ], [ -70.448262, 41.353651 ], [ -70.821284, 41.251014 ], [ -70.833802, 41.353386 ] ] ], [ [ [ -73.695935802169586, 41.115255456904094 ], [ -73.264957, 42.74594 ], [ -72.458519, 42.726853 ], [ -72.046302, 44.291983 ], [ -71.579974, 44.501778 ], [ -71.438546, 45.239004 ], [ -70.634661, 45.383608 ], [ -69.997086, 46.69523 ], [ -69.219996, 47.457159 ], [ -67.789761, 47.065744 ], [ -67.803313, 45.677886 ], [ -66.949895, 44.817419 ], [ -68.617085, 44.010097 ], [ -69.040193, 44.233673 ], [ -70.553854, 43.321886 ], [ -70.997838, 42.321205 ], [ -70.441718, 41.752898 ], [ -70.049382, 42.064689 ], [ -69.964982, 41.55111 ], [ -70.321588, 41.630508 ], [ -70.948431, 41.409193 ], [ -70.765463, 41.641575 ], [ -73.695935802169586, 41.115255456904094 ] ] ] ] } },
  { "type": "Feature", "properties": { "name": "United States Court of Appeals for the 2nd Circuit" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -72.018926, 41.274114 ], [ -71.926802, 41.290122 ], [ -71.917281, 41.251333 ], [ -72.034754, 41.234818 ], [ -72.018926, 41.274114 ] ] ], [ [ [ -79.761951, 42.26986 ], [ -78.851355, 42.791758 ], [ -79.070469, 43.262454 ], [ -76.235834, 43.529256 ], [ -76.334584, 44.164945 ], [ -74.992756, 44.977449 ], [ -71.482503206850041, 45.009866942435572 ], [ -71.579974, 44.501778 ], [ -72.046302, 44.291983 ], [ -72.458519, 42.726853 ], [ -73.264957, 42.74594 ], [ -73.766276, 40.881099 ], [ -71.936977, 41.006137 ], [ -74.260611, 40.502436 ], [ -73.893979, 40.997197 ], [ -75.341125, 41.992772 ], [ -79.761313, 41.998808 ], [ -79.761951, 42.26986 ] ] ] ] } },
  { "type": "Feature", "properties": { "name": "United States Court of Appeals for the 8th Circuit" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -90.304125391072844, 35.002275955743421 ], [ -91.088696, 33.961334 ], [ -91.166073, 33.004106 ], [ -94.042964, 33.019219 ], [ -94.043428, 33.551425 ], [ -94.485875, 33.637867 ], [ -94.591933, 39.155003 ], [ -95.113557, 39.553941 ], [ -94.95154, 39.900533 ], [ -102.051744, 40.003078 ], [ -102.051614, 41.002377 ], [ -104.053249, 41.001406 ], [ -104.048736, 48.999877 ], [ -95.153711, 48.998903 ], [ -95.153314, 49.384358 ], [ -94.61901, 48.737374 ], [ -93.815178, 48.526508 ], [ -89.489226, 48.014528 ], [ -92.292192, 46.663242 ], [ -92.294033, 46.074377 ], [ -92.887929, 45.639006 ], [ -92.805287, 44.768361 ], [ -91.291002, 43.852733 ], [ -91.070716, 42.775502 ], [ -90.161159, 42.106372 ], [ -90.339528, 41.598633 ], [ -91.027787, 41.423603 ], [ -91.511956, 40.170441 ], [ -90.657254, 38.92027 ], [ -90.113327, 38.849306 ], [ -90.363926, 38.236355 ], [ -89.160995967735829, 37.008349286285352 ], [ -90.304125391072844, 35.002275955743421 ] ] ] ] } },
  { "type": "Feature", "properties": { "name": "United States Court of Appeals for the 3rd Circuit" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -75.528088, 39.498114 ], [ -75.593068, 39.479186 ], [ -75.396277, 39.057884 ], [ -75.089473, 38.797198 ], [ -75.048939, 38.451263 ], [ -75.693721, 38.460128 ], [ -75.788596, 39.722199 ], [ -80.519342, 39.721403 ], [ -80.627171, 40.619936 ], [ -80.519425, 41.977523 ], [ -79.761951, 42.26986 ], [ -79.761313, 41.998808 ], [ -75.341125, 41.992772 ], [ -73.893979, 40.997197 ], [ -74.260611, 40.502436 ], [ -73.976982, 40.408508 ], [ -74.101443, 39.756173 ], [ -74.807917, 38.985948 ], [ -75.528088, 39.498114 ] ] ] ] } },
  { "type": "Feature", "properties": { "name": "United States Court of Appeals for the 5th Circuit" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -94.042964, 33.019219 ], [ -91.166073, 33.004106 ], [ -91.088696, 33.961334 ], [ -90.309297, 34.995694 ], [ -88.200064, 34.995634 ], [ -88.395023, 30.369425 ], [ -89.845065, 30.01841 ], [ -89.183256, 30.149344 ], [ -89.602109, 29.610295 ], [ -89.01428, 29.166913 ], [ -89.400966, 28.933812 ], [ -89.842641, 29.318823 ], [ -90.867853, 29.056064 ], [ -91.667128, 29.745822 ], [ -91.821579, 29.473925 ], [ -93.295573, 29.775071 ], [ -94.670389, 29.43078 ], [ -97.003325, 27.908307 ], [ -97.372864, 25.840117 ], [ -99.082002, 26.39651 ], [ -99.530138, 27.580207 ], [ -101.400636, 29.738079 ], [ -102.677192, 29.738261 ], [ -103.28119, 28.982138 ], [ -104.539761, 29.676074 ], [ -104.924796, 30.604832 ], [ -106.63588, 31.871514 ], [ -103.064423, 32.000518 ], [ -103.041924, 36.500439 ], [ -100.000406, 36.499702 ], [ -100.000381, 34.560509 ], [ -99.696462, 34.381036 ], [ -97.149394, 33.721967 ], [ -95.226393, 33.961954 ], [ -94.043428, 33.551425 ], [ -94.042964, 33.019219 ] ] ] ] } },
  { "type": "Feature", "properties": { "name": "United States Court of Appeals for the 9th Circuit" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -156.049651, 19.780452 ], [ -155.853293, 20.271548 ], [ -154.816009, 19.500648 ], [ -155.672005, 18.917466 ], [ -156.049651, 19.780452 ] ] ], [ [ [ -157.05913, 20.913407 ], [ -156.937529, 20.925274 ], [ -156.808469, 20.820396 ], [ -156.96789, 20.73508 ], [ -157.05913, 20.913407 ] ] ], [ [ [ -156.670469, 20.559909 ], [ -156.56714, 20.604895 ], [ -156.539643, 20.527644 ], [ -156.668809, 20.504738 ], [ -156.670469, 20.559909 ] ] ], [ [ [ -156.69989, 20.920629 ], [ -156.242555, 20.937838 ], [ -155.985413, 20.744245 ], [ -156.377633, 20.578427 ], [ -156.69989, 20.920629 ] ] ], [ [ [ -157.27722, 21.158431 ], [ -157.26069, 21.225684 ], [ -156.709106, 21.158655 ], [ -156.877137, 21.0493 ], [ -157.27722, 21.158431 ] ] ], [ [ [ -158.232192, 21.583806 ], [ -157.968628, 21.712704 ], [ -157.6518, 21.3139 ], [ -158.1033, 21.2979 ], [ -158.232192, 21.583806 ] ] ], [ [ [ -160.24961, 21.815145 ], [ -160.193959, 21.922386 ], [ -160.058543, 21.99638 ], [ -160.079065, 21.89608 ], [ -160.24961, 21.815145 ] ] ], [ [ [ -159.783746, 22.064897 ], [ -159.581058, 22.223488 ], [ -159.293013, 22.12296 ], [ -159.444868, 21.868627 ], [ -159.783746, 22.064897 ] ] ], [ [ [ -179.174265, 51.279057 ], [ -178.995591, 51.414484 ], [ -178.908883, 51.340582 ], [ -179.126856, 51.219862 ], [ -179.174265, 51.279057 ] ] ], [ [ [ -123.237148, 48.683466 ], [ -122.818436, 48.744629 ], [ -122.803521, 48.428748 ], [ -123.141478, 48.505291 ], [ -123.237148, 48.683466 ] ] ], [ [ [ 179.481318, 51.975301 ], [ 179.636846, 52.025712 ], [ 179.773922, 51.970693 ], [ 179.649484, 51.87367 ], [ 179.481318, 51.975301 ] ] ], [ [ [ -172.612274, 52.306828 ], [ -172.448182, 52.391439 ], [ -172.301445, 52.329951 ], [ -172.639992, 52.244765 ], [ -172.612274, 52.306828 ] ] ], [ [ [ -170.817943, 52.636275 ], [ -170.671545, 52.698082 ], [ -170.532144, 52.679971 ], [ -170.788495, 52.54024 ], [ -170.817943, 52.636275 ] ] ], [ [ [ 173.863992, 52.792483 ], [ 174.140115, 52.750737 ], [ 174.158146, 52.706059 ], [ 173.819039, 52.759805 ], [ 173.863992, 52.792483 ] ] ], [ [ [ 172.458911, 52.954548 ], [ 173.121988, 52.990352 ], [ 173.423819, 52.828799 ], [ 172.903628, 52.761667 ], [ 172.458911, 52.954548 ] ] ], [ [ [ 173.439026, 52.470528 ], [ 173.638061, 52.524209 ], [ 173.772799, 52.509905 ], [ 173.725696, 52.356579 ], [ 173.439026, 52.470528 ] ] ], [ [ [ -171.312658, 52.493502 ], [ -171.256768, 52.52858 ], [ -171.196013, 52.500106 ], [ -171.226729, 52.434269 ], [ -171.312658, 52.493502 ] ] ], [ [ [ 178.093673, 52.055141 ], [ 178.154769, 52.061421 ], [ 178.2009, 51.991156 ], [ 178.120941, 51.977012 ], [ 178.093673, 52.055141 ] ] ], [ [ [ -175.301556, 52.055602 ], [ -174.185347, 52.417788 ], [ -172.947811, 52.107371 ], [ -173.513047, 52.02531 ], [ -175.301556, 52.055602 ] ] ], [ [ [ 178.600493, 51.655256 ], [ 178.92533, 51.623904 ], [ 179.480418, 51.36386 ], [ 179.253271, 51.337239 ], [ 178.600493, 51.655256 ] ] ], [ [ [ -178.889347, 51.570352 ], [ -178.678149, 51.62601 ], [ -178.551475, 51.610175 ], [ -178.734585, 51.542326 ], [ -178.889347, 51.570352 ] ] ], [ [ [ 178.204442, 51.83089 ], [ 178.329699, 51.836792 ], [ 178.374074, 51.747856 ], [ 178.270955, 51.765186 ], [ 178.204442, 51.83089 ] ] ], [ [ [ -178.19709, 51.905464 ], [ -177.952094, 51.915348 ], [ -177.615311, 51.85508 ], [ -177.909185, 51.596671 ], [ -178.19709, 51.905464 ] ] ], [ [ [ -177.670119, 51.743381 ], [ -177.181271, 51.943167 ], [ -177.04509, 51.898605 ], [ -177.18994, 51.697217 ], [ -177.670119, 51.743381 ] ] ], [ [ [ -178.876843, 51.837917 ], [ -178.779657, 51.851547 ], [ -178.733355, 51.783947 ], [ -178.895958, 51.779219 ], [ -178.876843, 51.837917 ] ] ], [ [ [ -176.950128, 51.686719 ], [ -176.14951, 52.11757 ], [ -175.424859, 51.972332 ], [ -176.715424, 51.620422 ], [ -176.950128, 51.686719 ] ] ], [ [ [ 178.463385, 51.987849 ], [ 178.552612, 51.973968 ], [ 178.591597, 51.952652 ], [ 178.502493, 51.899644 ], [ 178.463385, 51.987849 ] ] ], [ [ [ 177.213086, 51.920358 ], [ 177.581271, 52.144927 ], [ 177.675952, 52.092167 ], [ 177.601005, 51.922254 ], [ 177.213086, 51.920358 ] ] ], [ [ [ -120.368278, 34.076465 ], [ -120.055107, 34.037729 ], [ -119.973691, 33.942481 ], [ -120.454134, 34.028081 ], [ -120.368278, 34.076465 ] ] ], [ [ [ -114.799683, 32.593621 ], [ -117.124862, 32.534156 ], [ -117.445583, 33.268517 ], [ -118.519514, 34.027509 ], [ -120.622575, 34.554017 ], [ -120.635787, 35.123805 ], [ -122.397065, 37.187249 ], [ -122.262861, 38.051473 ], [ -123.011533, 38.003438 ], [ -123.71054, 38.91323 ], [ -123.851714, 39.832041 ], [ -124.409591, 40.438076 ], [ -124.063076, 41.439579 ], [ -124.552441, 42.840568 ], [ -124.041128, 46.197672 ], [ -123.547659, 46.259109 ], [ -124.080671, 46.267239 ], [ -123.923269, 46.672708 ], [ -124.725839, 48.386012 ], [ -122.616701, 47.925139 ], [ -122.75802, 49.002357 ], [ -104.048736, 48.999877 ], [ -104.039138, 44.99852 ], [ -111.044275, 45.001345 ], [ -111.046689, 42.001567 ], [ -114.041723, 41.99372 ], [ -114.0506, 37.000396 ], [ -109.045223, 36.999084 ], [ -109.050044, 31.332502 ], [ -111.074825, 31.332239 ], [ -114.799683, 32.593621 ] ] ], [ [ [ -118.594033, 33.035951 ], [ -118.446771, 32.895424 ], [ -118.353504, 32.821962 ], [ -118.487908, 32.84459 ], [ -118.594033, 33.035951 ] ] ], [ [ [ -119.578942, 33.278628 ], [ -119.510489, 33.307269 ], [ -119.429559, 33.228167 ], [ -119.545872, 33.233406 ], [ -119.578942, 33.278628 ] ] ], [ [ [ -118.593969, 33.467198 ], [ -118.484785, 33.487483 ], [ -118.286261, 33.351463 ], [ -118.465368, 33.326056 ], [ -118.593969, 33.467198 ] ] ], [ [ [ -119.916216, 34.058351 ], [ -119.364214, 34.050794 ], [ -119.363065, 34.000548 ], [ -119.795938, 33.962929 ], [ -119.916216, 34.058351 ] ] ], [ [ [ -165.602225, 54.045267 ], [ -165.00791, 54.134934 ], [ -164.7637, 54.223153 ], [ -164.956139, 54.060988 ], [ -165.602225, 54.045267 ] ] ], [ [ [ -166.06155, 54.185092 ], [ -165.62555, 54.298964 ], [ -165.383719, 54.196731 ], [ -165.875129, 54.03642 ], [ -166.06155, 54.185092 ] ] ], [ [ [ -167.790928, 53.33552 ], [ -167.031252, 53.945204 ], [ -166.075283, 53.969571 ], [ -166.749158, 53.440944 ], [ -167.790928, 53.33552 ] ] ], [ [ [ -173.074642, 60.704657 ], [ -172.847344, 60.516742 ], [ -172.254263, 60.297375 ], [ -173.0638, 60.502589 ], [ -173.074642, 60.704657 ] ] ], [ [ [ -171.83683, 63.564883 ], [ -170.344855, 63.694225 ], [ -168.685145, 63.296427 ], [ -169.638309, 62.937527 ], [ -171.83683, 63.564883 ] ] ], [ [ [ -156.733628, 56.077593 ], [ -156.614757, 56.065178 ], [ -156.618202, 56.017802 ], [ -156.681814, 55.994337 ], [ -156.733628, 56.077593 ] ] ], [ [ [ -155.750002, 55.821849 ], [ -155.605373, 55.928826 ], [ -155.530591, 55.912213 ], [ -155.591002, 55.761725 ], [ -155.750002, 55.821849 ] ] ], [ [ [ -169.81831, 56.633612 ], [ -169.474322, 56.625183 ], [ -169.453786, 56.583786 ], [ -169.685825, 56.539717 ], [ -169.81831, 56.633612 ] ] ], [ [ [ -170.420047, 57.212917 ], [ -170.143996, 57.242804 ], [ -170.133884, 57.181329 ], [ -170.286318, 57.128169 ], [ -170.420047, 57.212917 ] ] ], [ [ [ -153.597411, 59.386827 ], [ -153.412493, 59.415105 ], [ -153.347772, 59.377985 ], [ -153.515286, 59.320878 ], [ -153.597411, 59.386827 ] ] ], [ [ [ -167.430619, 60.197006 ], [ -166.149763, 60.4367 ], [ -165.532633, 59.953425 ], [ -166.190406, 59.750206 ], [ -167.430619, 60.197006 ] ] ], [ [ [ -161.078486, 58.635577 ], [ -161.056595, 58.702202 ], [ -160.679309, 58.780226 ], [ -160.880515, 58.581325 ], [ -161.078486, 58.635577 ] ] ], [ [ [ -133.935016, 55.920689 ], [ -133.582116, 56.352506 ], [ -132.966922, 56.224276 ], [ -131.957914, 54.791239 ], [ -132.866355, 54.700386 ], [ -133.935016, 55.920689 ] ] ], [ [ [ -134.392983, 56.864284 ], [ -133.104611, 57.005701 ], [ -132.611326, 56.599913 ], [ -133.821628, 56.391602 ], [ -134.311763, 55.812285 ], [ -134.392983, 56.864284 ] ] ], [ [ [ -157.288702, 56.566039 ], [ -157.172027, 56.598039 ], [ -156.975549, 56.540446 ], [ -157.326059, 56.525169 ], [ -157.288702, 56.566039 ] ] ], [ [ [ -154.840415, 56.42032 ], [ -154.514078, 56.604059 ], [ -153.878764, 56.565925 ], [ -154.02093, 56.482025 ], [ -154.840415, 56.42032 ] ] ], [ [ [ -136.563223, 58.035052 ], [ -135.78338, 58.286709 ], [ -134.950844, 58.036993 ], [ -134.674028, 56.166925 ], [ -136.563223, 58.035052 ] ] ], [ [ [ -154.779663, 57.366335 ], [ -152.560171, 58.61968 ], [ -151.795696, 58.211096 ], [ -152.766673, 58.029887 ], [ -152.212247, 57.791433 ], [ -152.253603, 57.384019 ], [ -154.017042, 56.689311 ], [ -154.779663, 57.366335 ] ] ], [ [ [ -134.960502, 58.403758 ], [ -134.699956, 58.161494 ], [ -134.174352, 58.125284 ], [ -133.786398, 57.311528 ], [ -134.565687, 57.023737 ], [ -134.960502, 58.403758 ] ] ], [ [ [ -152.064099, 60.417137 ], [ -151.952456, 60.510609 ], [ -151.839194, 60.485862 ], [ -151.956263, 60.367841 ], [ -152.064099, 60.417137 ] ] ], [ [ [ -162.844362, 54.510428 ], [ -162.585315, 54.447995 ], [ -162.34484, 54.401336 ], [ -162.760247, 54.372193 ], [ -162.844362, 54.510428 ] ] ], [ [ [ -161.697129, 55.249148 ], [ -161.523434, 55.271659 ], [ -161.560207, 55.207045 ], [ -161.697129, 55.249148 ] ] ], [ [ [ -160.252749, 54.913251 ], [ -159.870591, 55.284889 ], [ -159.203228, 54.914842 ], [ -159.752779, 55.066139 ], [ -160.252749, 54.913251 ] ] ], [ [ [ -161.426005, 55.216563 ], [ -161.329875, 55.219418 ], [ -161.344152, 55.158504 ], [ -161.451286, 55.178027 ], [ -161.426005, 55.216563 ] ] ], [ [ [ -160.856621, 55.318488 ], [ -160.687442, 55.402198 ], [ -160.137032, 55.450709 ], [ -160.525226, 55.129871 ], [ -160.856621, 55.318488 ] ] ], [ [ [ -168.12893, 65.655744 ], [ -164.400724, 66.58111 ], [ -163.603956, 66.558089 ], [ -163.925152, 66.225078 ], [ -163.695394, 66.059552 ], [ -160.993965, 66.234444 ], [ -166.838969, 68.337186 ], [ -166.328459, 68.442261 ], [ -166.224187, 68.873175 ], [ -163.574034, 69.124077 ], [ -161.879266, 70.329269 ], [ -156.56865, 71.352561 ], [ -155.587702, 71.17256 ], [ -155.979264, 70.918524 ], [ -155.731842, 70.83116 ], [ -155.060764, 71.145422 ], [ -151.175187, 70.375558 ], [ -143.281878, 70.151052 ], [ -141.002672, 69.645609 ], [ -141.00184, 60.306105 ], [ -139.086669, 60.357654 ], [ -139.200346, 60.090701 ], [ -137.526424, 58.906834 ], [ -136.581521, 59.164909 ], [ -136.350622, 59.599326 ], [ -135.231148, 59.697176 ], [ -133.379908, 58.427909 ], [ -131.835133, 56.601849 ], [ -130.102761, 56.116696 ], [ -129.982348, 55.302079 ], [ -130.686192, 54.71691 ], [ -131.093806, 55.191335 ], [ -131.594567, 54.93113 ], [ -132.067412, 55.875078 ], [ -133.070056, 56.330951 ], [ -132.45079, 56.564098 ], [ -132.556758, 56.757242 ], [ -132.93752, 57.048321 ], [ -133.466932, 57.159356 ], [ -134.146685, 58.199084 ], [ -134.936897, 58.457474 ], [ -136.70125, 58.219416 ], [ -139.861306, 59.546678 ], [ -139.608545, 59.821961 ], [ -145.988546, 60.387427 ], [ -151.858124, 59.144234 ], [ -151.205459, 59.630284 ], [ -151.869468, 59.769159 ], [ -151.410273, 60.711023 ], [ -149.717167, 61.011303 ], [ -150.535997, 61.269724 ], [ -151.720815, 60.904257 ], [ -152.700822, 59.920309 ], [ -154.122681, 59.287622 ], [ -153.267407, 58.867218 ], [ -154.222465, 58.132566 ], [ -158.371953, 56.467334 ], [ -158.117797, 56.230742 ], [ -158.431471, 55.994452 ], [ -161.253977, 55.355896 ], [ -161.587047, 55.62006 ], [ -161.863339, 55.266989 ], [ -161.550357, 55.065734 ], [ -164.743977, 54.394216 ], [ -164.948789, 54.579877 ], [ -164.57626, 54.895342 ], [ -163.343768, 54.974439 ], [ -161.807833, 55.891954 ], [ -160.508433, 55.869379 ], [ -160.385922, 56.279706 ], [ -158.656355, 56.810012 ], [ -157.678891, 57.563888 ], [ -157.541041, 58.377302 ], [ -156.993548, 58.836798 ], [ -158.140307, 58.61502 ], [ -158.619684, 58.911048 ], [ -158.880927, 58.39067 ], [ -160.31778, 59.070477 ], [ -162.171722, 58.648441 ], [ -161.824107, 58.734549 ], [ -162.048584, 59.254177 ], [ -161.70253, 59.490906 ], [ -162.37224, 60.167009 ], [ -164.133393, 59.845612 ], [ -165.420349, 60.550692 ], [ -164.991665, 60.69884 ], [ -165.057842, 61.059746 ], [ -166.211787, 61.608373 ], [ -164.442368, 63.202672 ], [ -163.053996, 63.058334 ], [ -162.352274, 63.454069 ], [ -162.587527, 63.625115 ], [ -161.073573, 63.5617 ], [ -160.76562, 63.828714 ], [ -161.504903, 64.423074 ], [ -160.935974, 64.82237 ], [ -162.768424, 64.333516 ], [ -165.001961, 64.433917 ], [ -166.413926, 64.651229 ], [ -166.911922, 65.125965 ], [ -166.347189, 65.276341 ], [ -168.12893, 65.655744 ] ] ], [ [ [ -170.170683, 52.784918 ], [ -169.820198, 53.06679 ], [ -169.680033, 53.035075 ], [ -169.703873, 52.777117 ], [ -170.170683, 52.784918 ] ] ], [ [ [ -169.28652, 52.784747 ], [ -168.342127, 53.475992 ], [ -167.789164, 53.519329 ], [ -168.755531, 52.907507 ], [ -169.28652, 52.784747 ] ] ] ] } },
  { "type": "Feature", "properties": { "name": "United States Court of Appeals for the 4th Circuit" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -83.343526598791286, 34.678148713714648 ], [ -83.108606, 35.000659 ], [ -84.302642802417438, 35.009041612924626 ], [ -83.771736, 35.562118 ], [ -81.694667798419971, 36.341857387075372 ], [ -81.6469, 36.611918 ], [ -83.675413, 36.600814 ], [ -81.968297, 37.537798 ], [ -82.593673, 38.421809 ], [ -80.865575, 39.662751 ], [ -80.627171, 40.619936 ], [ -80.519342, 39.721403 ], [ -75.788596, 39.722199 ], [ -75.693721, 38.460128 ], [ -75.048939, 38.451263 ], [ -75.942399, 37.089607 ], [ -75.669711, 37.950796 ], [ -76.39035, 38.757004 ], [ -76.012312, 39.453115 ], [ -76.525785, 39.177908 ], [ -76.322093, 38.036503 ], [ -77.016371, 38.445572 ], [ -77.211188, 38.380662 ], [ -77.1302, 38.635017 ], [ -77.322622, 38.467131 ], [ -77.265295, 38.333165 ], [ -76.236725, 37.889174 ], [ -76.437525, 37.37975 ], [ -75.533627, 35.225825 ], [ -77.462922, 34.471354 ], [ -77.960172, 33.853315 ], [ -78.772737, 33.768511 ], [ -80.885517, 32.0346 ], [ -83.343526598791286, 34.678148713714648 ] ], [ [ -77.119759, 38.934343 ], [ -77.039006, 38.791645 ], [ -76.909393, 38.892852 ], [ -77.041018, 38.995548 ], [ -77.119759, 38.934343 ] ] ], [ [ [ -76.046213, 38.025533 ], [ -75.980089, 38.004891 ], [ -75.984648, 37.938121 ], [ -76.04653, 37.953586 ], [ -76.046213, 38.025533 ] ] ] ] } },
  { "type": "Feature", "properties": { "name": "United States Court of Appeals for the 10th Circuit" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -109.049195, 31.796551 ], [ -109.045223, 36.999084 ], [ -114.0506, 37.000396 ], [ -114.041723, 41.99372 ], [ -111.046689, 42.001567 ], [ -111.044275, 45.001345 ], [ -104.057698, 44.997431 ], [ -104.053249, 41.001406 ], [ -102.051614, 41.002377 ], [ -102.051744, 40.003078 ], [ -94.952483649186277, 39.896444088702793 ], [ -95.113557, 39.553941 ], [ -94.591933, 39.155003 ], [ -94.485875, 33.637867 ], [ -95.226393, 33.961954 ], [ -97.149394, 33.721967 ], [ -99.696462, 34.381036 ], [ -100.000381, 34.560509 ], [ -100.000406, 36.499702 ], [ -103.041924, 36.500439 ], [ -103.064423, 32.000518 ], [ -106.63588, 31.871514 ], [ -108.208394, 31.783599 ], [ -108.208573, 31.333395 ], [ -109.050044, 31.332502 ], [ -109.049195, 31.796551 ] ] ] ] } },
  { "type": "Feature", "properties": { "name": "United States Court of Appeals for the 11th Circuit" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -82.188031, 24.574699 ], [ -82.144099, 24.622481 ], [ -82.086643, 24.590071 ], [ -82.100757, 24.533288 ], [ -82.188031, 24.574699 ] ] ], [ [ [ -82.01491, 24.543071 ], [ -81.983908, 24.580682 ], [ -81.868711, 24.58412 ], [ -81.918855, 24.498131 ], [ -82.01491, 24.543071 ] ] ], [ [ [ -81.811693, 24.568745 ], [ -81.44351, 24.813364 ], [ -81.243232, 24.673998 ], [ -81.685243, 24.558676 ], [ -81.811693, 24.568745 ] ] ], [ [ [ -81.444124, 30.709714 ], [ -80.03212, 26.77153 ], [ -80.163156, 25.452184 ], [ -80.651189, 24.866131 ], [ -81.103373, 24.669463 ], [ -80.495394, 25.199808 ], [ -81.079859, 25.118797 ], [ -82.180717, 26.476257 ], [ -82.743017, 27.531086 ], [ -82.448786, 27.810036 ], [ -82.846526, 27.854301 ], [ -82.688864, 28.905609 ], [ -83.679219, 29.918513 ], [ -84.20801, 30.084776 ], [ -85.045074, 29.586991 ], [ -86.222561, 30.343585 ], [ -87.893201, 30.239237 ], [ -88.008396, 30.684956 ], [ -88.395023, 30.369425 ], [ -88.202959, 35.008028 ], [ -83.108606, 35.000659 ], [ -83.33869, 34.682002 ], [ -80.84313, 32.024226 ], [ -81.444124, 30.709714 ] ] ] ] } },
  { "type": "Feature", "properties": { "name": "United States Court of Appeals for the 6th Circuit" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -82.863342, 41.693693 ], [ -82.782719, 41.694003 ], [ -82.788876, 41.643047 ], [ -82.842099, 41.628323 ], [ -82.863342, 41.693693 ] ] ], [ [ [ -89.221332, 47.908069 ], [ -88.631908, 48.148307 ], [ -88.425162, 48.21065 ], [ -88.898986, 47.900685 ], [ -89.221332, 47.908069 ] ] ], [ [ [ -90.300697, 35.001601076615579 ], [ -89.058036, 37.188767 ], [ -88.476127, 37.068223 ], [ -87.87254, 37.920999 ], [ -86.033386, 37.970382 ], [ -85.448862, 38.713368 ], [ -84.812877, 38.786087 ], [ -84.805883, 41.760216 ], [ -86.824828, 41.76024 ], [ -86.208309, 42.762789 ], [ -86.514702, 44.058119 ], [ -86.058862, 44.911012 ], [ -84.912956, 45.409776 ], [ -85.014509, 45.760329 ], [ -83.488826, 45.355872 ], [ -83.336988, 44.332919 ], [ -83.94774, 43.735165 ], [ -82.793205, 44.023247 ], [ -82.415937, 43.005555 ], [ -83.453832, 41.732647 ], [ -82.460599, 41.386316 ], [ -80.519425, 41.977523 ], [ -80.627171, 40.619936 ], [ -80.865575, 39.662751 ], [ -82.593673, 38.421809 ], [ -81.968297, 37.537798 ], [ -83.675413, 36.600814 ], [ -81.6469, 36.611918 ], [ -81.694667798419971, 36.341857387075372 ], [ -83.771736, 35.562118 ], [ -84.321869, 34.988408 ], [ -90.300697, 35.001601076615579 ] ] ], [ [ [ -84.61622, 45.89447 ], [ -84.517895, 45.828543 ], [ -84.35602, 45.771895 ], [ -84.484128, 45.73071 ], [ -84.61622, 45.89447 ] ] ], [ [ [ -86.138095, 45.043038 ], [ -86.04443, 45.159582 ], [ -85.954021, 45.119281 ], [ -86.081487, 44.990096 ], [ -86.138095, 45.043038 ] ] ], [ [ [ -85.701809, 45.736129 ], [ -85.524448, 45.829794 ], [ -85.360952, 45.817554 ], [ -85.561634, 45.572213 ], [ -85.701809, 45.736129 ] ] ], [ [ [ -90.418136, 46.566094 ], [ -87.801184, 47.473301 ], [ -88.477935, 46.85056 ], [ -86.810967, 46.449663 ], [ -84.964652, 46.772845 ], [ -84.969464, 46.47629 ], [ -84.117925, 46.517619 ], [ -84.114941, 46.174114 ], [ -83.480639, 45.996164 ], [ -86.278007, 45.942057 ], [ -87.590208, 45.095264 ], [ -88.115346, 45.922211 ], [ -90.418136, 46.566094 ] ] ] ] } },
  { "type": "Feature", "properties": { "name": "United States Court of Appeals for the 7th Circuit" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -91.506167908622288, 40.200643512795097 ], [ -91.027787, 41.423603 ], [ -90.140613, 41.995999 ], [ -91.070716, 42.775502 ], [ -91.291002, 43.852733 ], [ -92.805287, 44.768361 ], [ -92.887929, 45.639006 ], [ -92.294033, 46.074377 ], [ -92.292192, 46.663242 ], [ -90.924128, 47.001888 ], [ -90.95565, 46.592503 ], [ -90.418136, 46.566094 ], [ -88.115346, 45.922211 ], [ -87.590208, 45.095264 ], [ -88.005518, 44.539216 ], [ -86.97778, 45.290684 ], [ -87.889207, 43.307652 ], [ -87.60945, 41.845233 ], [ -84.805883, 41.760216 ], [ -84.812877, 38.786087 ], [ -85.448862, 38.713368 ], [ -86.033386, 37.970382 ], [ -87.875129274198144, 37.915654120966984 ], [ -88.476127, 37.068223 ], [ -89.057916992469217, 37.18876258819126 ], [ -89.160926660065769, 37.008422224362079 ], [ -90.363926, 38.236355 ], [ -90.113327, 38.849306 ], [ -90.657254, 38.92027 ], [ -91.506167908622288, 40.200643512795097 ] ] ], [ [ [ -86.934276, 45.421149 ], [ -86.805868, 45.412903 ], [ -86.899891, 45.295185 ], [ -86.956198, 45.352006 ], [ -86.934276, 45.421149 ] ] ], [ [ [ -90.776921, 47.024324 ], [ -90.560936, 47.037013 ], [ -90.511623, 46.961407 ], [ -90.637124, 46.906724 ], [ -90.776921, 47.024324 ] ] ] ] } }
  ]
  }

  var map = L.map("map").setView([0,0],2);
  var Esri_WorldTopoMap = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}', {
    attribution: 'Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ, TomTom, Intermap, iPC, USGS, FAO, NPS, NRCAN, GeoBase, Kadaster NL, Ordnance Survey, Esri Japan, METI, Esri China (Hong Kong), and the GIS User Community'
  });
  function circuitsStyle(feature, layer) {
    if (feature.properties && feature.properties.name) {
      var theClassName = feature.properties.name.replace(/ /g,"-").toLowerCase();
      return {className: theClassName+" region-area", color: "#b30024", fillColor: "#b30024"};
    }
  }
  var circuits = L.geoJSON(regionGeometry,{ style: circuitsStyle }).addTo(map);
  Esri_WorldTopoMap.addTo(map);

  var countMax = counts.reduce(function(a,b){return Math.max(a,b);},1);
  var countMin = counts.reduce(function(a,b){return Math.min(a,b);},1)
  for (var key in regions) {
    if (regions.hasOwnProperty(key)) {
      var rgn = regions[key]
      var circle = L.circleMarker([rgn['lat'],rgn['lon']], {
        color: '#b30024',
        fillColor: '#b30024',
        fillOpacity: 0.3,
        radius: scaleRangeValue(rgn['count'],countMin,countMax),
        weight: 2,
        className: key.replace(/ /g,"-").toLowerCase()
      });
      circle.bindPopup(rgn['nameLink']+': '+rgn['count']+" documents");
      circle.on('mouseover', function(e) { $(".region-area."+this.options.className).css("display","block"); });
      circle.on('mouseout', function(e) { $(".region-area."+this.options.className).css("display","none"); });
      circle.addTo(map);
    }
  }
}

function addToRegions(regions,name,lat,long,count,searchLink) {
  if (count > 0) {
    // if (name in regionLookup) {
    //   aggRegion = regionLookup[name];
    //   if (aggRegion in regions) {
    //     regions[aggRegion]['count'] = regions[aggRegion]['count'] + count;
    //   } else {
    //     regions[aggRegion] = {
    //       'lat': regionCenters[aggRegion][0],
    //       'lon': regionCenters[aggRegion][1],
    //       'name': aggRegion,
    //       'count': count,
    //       // 'nameLink': '<a href="#">'+aggRegion+'</a>'
    //       'nameLink': searchLink
    //     };
    //   }
    // } else {
      regions[name] = {
        'lat':lat,
        'lon':long,
        'name':name,
        'count':count,
        'nameLink':searchLink,
      };
    // }
  }
}
